<!DOCTYPE html>

<html lang="zh-Hant"><head><link href="css/styles.css" rel="stylesheet"/>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title> AutoFixMermaid</title>
</head><body>
<header>
  <select id="engineSelect">
  <option value="rules">Rules（規則）</option>
  <option value="ai">AI</option>
</select>

<select id="aiProvider">
  <option value="ollama">Ollama</option>
  <option value="webllm">WebLLM</option>
  <option value="none">None</option>
</select>
<h1>Mermaid AutoFix V2.2a（Label () fix）</h1>
<div class="toolbar">
<button class="btn" id="btnDebug">除錯</button>
<button class="btn" id="btnRules">規則</button>
<button class="btn" id="btnRender">直接渲染</button>
<button class="btn" id="btnFixRender">自動修正＋渲染</button>
<button class="btn" id="btnSelfTest">自我檢測</button>
<button class="btn" id="btnHealth">健康檢測</button>
<label style="margin-left:8px;">來源</label>
<label style="margin-left:8px;">引擎</label>
<select id="engineMode" class="select">
  <option value="classic" selected>經典（WTS→引擎→Mock）</option>
  <option value="ai">AI（實驗）</option>
</select>
<label><input type="radio" name="sourceMode" value="auto" checked>自動</label>
<label><input type="radio" name="sourceMode" value="mermaid">Mermaid</label>
<label><input type="radio" name="sourceMode" value="python">Python</label>
<label style="margin-left:12px;"><input type="checkbox" id="autoRender">即時渲染</label>
<label>專案檔案</label>
<input id="fileInput" type="file" webkitdirectory directory multiple />
<label>圖表類型</label>
<select class="select" id="diagramType">
  <option value="flowchart">flowchart</option>
  <option value="classDiagram">classDiagram</option>
  <option value="sequenceDiagram">sequenceDiagram</option>
</select>
<label>PNG 背景</label>
<input class="select" id="pngBG" placeholder="#ffffff 或 transparent" style="width:160px" type="text" value="transparent"/>
<label style="margin-left:12px;">圖表尺寸</label>
<input id="svgW" min="0" placeholder="寬度(自動)" type="number"/>
<input id="svgH" min="0" placeholder="高度(自動)" type="number"/>
<label>Security</label><select class="select" id="secLevel"><option selected="" value="strict">strict</option><option value="loose">loose</option></select>
<button class="btn" disabled="" id="btnExportImage">輸出圖片</button>
<button class="btn" disabled="" id="btnExportMMD">匯出 MMD</button>
<button class="btn" disabled="" id="btnExportSVG">匯出 SVG</button>
<button class="btn" disabled="" id="btnExportPNG">匯出 PNG</button>
<button class="btn" disabled="" id="btnExportErrors">匯出 errors.json</button>
<button class="btn" disabled="" id="btnExportFixlog">匯出 fixlog.json</button>
<span id="status">-</span> <span id="statusMsg" style="color:#666"></span>
</div>
</header>
<div class="notice" id="notice"></div>
<main>
<section id="debugPanel" style="display:none;border:1px solid #ccc;padding:8px;margin-bottom:8px;">
  <header>除錯面板</header>
  <pre id="debugLog" style="background:#f8f8f8;max-height:200px;overflow:auto;"></pre>
</section>
<section id="rulesPanel" style="display:none;border:1px solid #ccc;padding:8px;margin-bottom:8px;">
  <header>規則設定</header>
  <textarea id="rulesConfig" style="width:100%;height:120px;" placeholder="可在此編輯/新增優化規則(JSON)"></textarea>
  <button id="btnSaveRules">儲存規則</button>
</section>
<section><header>輸入</header><textarea id="src" placeholder="在此貼上 Mermaid 代碼..." spellcheck="false"></textarea></section>
<section><header>錯誤 / 修正日誌</header><pre id="log"></pre></section>
<section><header>預覽（SVG）</header><div id="graphDiv"><div id="svg"></div></div></section>
</main>
<script src="js/vendor/mermaid.min.js"></script>
<!-- Optional offline canvg: <script src="js/vendor/canvg.min.js"></script> -->
<script src="js/main.js" type="module"></script></body></html>